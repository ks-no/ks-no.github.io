<!DOCTYPE html>
<html lang="no" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.69.2" />
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Fiks IO :: KS Fiks</title>

    
    <link href="/css/nucleus.css?1679307551" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1679307551" rel="stylesheet">
    <link href="/css/hybrid.css?1679307551" rel="stylesheet">
    <link href="/css/featherlight.min.css?1679307551" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1679307551" rel="stylesheet">
    <link href="/css/auto-complete.css?1679307551" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1679307551" rel="stylesheet">
    <link href="/css/theme.css?1679307551" rel="stylesheet">
    <link href="/css/hugo-theme.css?1679307551" rel="stylesheet">
    
      <link href="/css/theme-ks.css?1679307551" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1679307551"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/tjenester/fiksprotokoll/fiksio/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img src="/images/ks-logo.svg" alt="KS logo" class="ks-logo"/>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1679307551"></script>
<script type="text/javascript" src="/js/auto-complete.js?1679307551"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1679307551"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

          
          
          


 
  
    
    <li data-nav-id="/felles/" title="Felles" class="dd-item 
        
        
        
        ">
      <a href="/felles/">
          Felles
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
          
          
            
            


 
  
    
      <li data-nav-id="/felles/dokumentlager/" title="Fiks dokumentlager" class="dd-item ">
        <a href="/felles/dokumentlager/">
        Fiks dokumentlager
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/felles/integrasjoner/" title="Integrasjoner" class="dd-item ">
        <a href="/felles/integrasjoner/">
        Integrasjoner
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/felles/difiidportenklient/" title="Maskinporten" class="dd-item ">
        <a href="/felles/difiidportenklient/">
        Maskinporten
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/felles/sentralisert-brukerstyring/" title="Sentralisert brukerstyring" class="dd-item 
        
        
        
        ">
      <a href="/felles/sentralisert-brukerstyring/">
          Sentralisert brukerstyring
          
      </a>
      
      
        <ul>
          
          
          
          
          
          
            
            


 
  
    
      <li data-nav-id="/felles/sentralisert-brukerstyring/azure/" title="Sette opp Azure AD" class="dd-item ">
        <a href="/felles/sentralisert-brukerstyring/azure/">
        Sette opp Azure AD
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/felles/sikkerhet/" title="Sikkerhet og personvern i Fiks-plattformen" class="dd-item ">
        <a href="/felles/sikkerhet/">
        Sikkerhet og personvern i Fiks-plattformen
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/felles/testmiljo/" title="Testmiljø" class="dd-item ">
        <a href="/felles/testmiljo/">
        Testmiljø
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tjenester/" title="Tjenester" class="dd-item 
        parent
        
        
        ">
      <a href="/tjenester/">
          Tjenester
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
          
          
            
            


 
  
    
      <li data-nav-id="/tjenester/bekymringsmelding/" title="Fiks bekymringsmelding" class="dd-item ">
        <a href="/tjenester/bekymringsmelding/">
        Fiks bekymringsmelding
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/digisos/" title="Fiks digisos" class="dd-item ">
        <a href="/tjenester/digisos/">
        Fiks digisos
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/innreise/" title="Fiks innreise" class="dd-item ">
        <a href="/tjenester/innreise/">
        Fiks innreise
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/kjoretoyregister/" title="Fiks kjøretøyregister" class="dd-item ">
        <a href="/tjenester/kjoretoyregister/">
        Fiks kjøretøyregister
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/klinikermelding/" title="Fiks klinikermelding" class="dd-item ">
        <a href="/tjenester/klinikermelding/">
        Fiks klinikermelding
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/tjenester/fiksmelding/" title="Fiks melding" class="dd-item 
        
        
        
        ">
      <a href="/tjenester/fiksmelding/">
          Fiks melding
          
      </a>
      
      
        <ul>
          
          
          
          
          
          
            
            


 
  
    
      <li data-nav-id="/tjenester/fiksmelding/edialog/" title="" class="dd-item ">
        <a href="/tjenester/fiksmelding/edialog/">
        
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/fiksmelding/del_dokument/" title="Fiks del dokument" class="dd-item ">
        <a href="/tjenester/fiksmelding/del_dokument/">
        Fiks del dokument
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/fiksmelding/fiks-sms/" title="Fiks SMS" class="dd-item ">
        <a href="/tjenester/fiksmelding/fiks-sms/">
        Fiks SMS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/tjenester/fiksprotokoll/" title="Fiks protokoll" class="dd-item 
        parent
        
        
        ">
      <a href="/tjenester/fiksprotokoll/">
          Fiks protokoll
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
          
          
             
            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/fiksprotokoll/arkiv/" title="Fiks arkiv" class="dd-item ">
        <a href="/tjenester/fiksprotokoll/arkiv/">
        Fiks arkiv
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/fiksprotokoll/arkivlett/" title="Fiks arkivlett byggesak" class="dd-item ">
        <a href="/tjenester/fiksprotokoll/arkivlett/">
        Fiks arkivlett byggesak
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/fiksprotokoll/fiksio/" title="Fiks IO" class="dd-item active">
        <a href="/tjenester/fiksprotokoll/fiksio/">
        Fiks IO
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/fiksprotokoll/matrikkelfoering/" title="Fiks matrikkelføring" class="dd-item ">
        <a href="/tjenester/fiksprotokoll/matrikkelfoering/">
        Fiks matrikkelføring
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/fiksprotokoll/plan/" title="Fiks plan" class="dd-item ">
        <a href="/tjenester/fiksprotokoll/plan/">
        Fiks plan
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/provesvar/" title="Fiks prøvesvar" class="dd-item ">
        <a href="/tjenester/provesvar/">
        Fiks prøvesvar
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/tjenester/register/" title="Fiks register" class="dd-item 
        
        
        
        ">
      <a href="/tjenester/register/">
          Fiks register
          
      </a>
      
      
        <ul>
          
          
          
          
          
          
            
            


 
  
    
      <li data-nav-id="/tjenester/register/folkeregister/" title="Folkeregister" class="dd-item ">
        <a href="/tjenester/register/folkeregister/">
        Folkeregister
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/register/skatteoginntektsopplysninger/" title="Skatte- og inntektsopplysninger" class="dd-item ">
        <a href="/tjenester/register/skatteoginntektsopplysninger/">
        Skatte- og inntektsopplysninger
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/dhis2/" title="Fiks smittesporing" class="dd-item ">
        <a href="/tjenester/dhis2/">
        Fiks smittesporing
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/vaksine/" title="Fiks vaksine" class="dd-item ">
        <a href="/tjenester/vaksine/">
        Fiks vaksine
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/tjenester/kslering/" title="KS læring" class="dd-item 
        
        
        
        ">
      <a href="/tjenester/kslering/">
          KS læring
          
      </a>
      
      
        <ul>
          
          
          
          
          
          
             
            
          
             
            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/tjenester/minkommune/" title="Min kommune" class="dd-item 
        
        
        
        ">
      <a href="/tjenester/minkommune/">
          Min kommune
          
      </a>
      
      
        <ul>
          
          
          
          
          
          
            
            


 
  
    
      <li data-nav-id="/tjenester/minkommune/faktura/" title="Min kommune - faktura" class="dd-item ">
        <a href="/tjenester/minkommune/faktura/">
        Min kommune - faktura
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/minkommune/innsyn/" title="Min kommune - innsyn" class="dd-item ">
        <a href="/tjenester/minkommune/innsyn/">
        Min kommune - innsyn
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/minkommune/kommunaletjenester/" title="Min kommune - kommunale tjenester" class="dd-item ">
        <a href="/tjenester/minkommune/kommunaletjenester/">
        Min kommune - kommunale tjenester
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/minkommune/matrikkel/" title="Min kommune - matrikkel" class="dd-item ">
        <a href="/tjenester/minkommune/matrikkel/">
        Min kommune - matrikkel
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/tjenester/svarut/" title="SvarUt" class="dd-item 
        
        
        
        ">
      <a href="/tjenester/svarut/">
          SvarUt
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
          
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/restv1/" title="API: Integrasjon med REST" class="dd-item ">
        <a href="/tjenester/svarut/restv1/">
        API: Integrasjon med REST
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/soapv11/" title="API: Integrasjon med SOAP" class="dd-item ">
        <a href="/tjenester/svarut/soapv11/">
        API: Integrasjon med SOAP
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/svarinn-rest/" title="API: SvarInn REST" class="dd-item ">
        <a href="/tjenester/svarut/svarinn-rest/">
        API: SvarInn REST
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/api-versjoner/" title="API: Versjonsoversikt" class="dd-item ">
        <a href="/tjenester/svarut/api-versjoner/">
        API: Versjonsoversikt
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/edialog/" title="Fiks edialog" class="dd-item ">
        <a href="/tjenester/svarut/edialog/">
        Fiks edialog
        
        </a>
    </li>
     
  
 

            
          
             
            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/konfigurasjon-av-svarut/" title="Konfigurasjon av SvarUT" class="dd-item ">
        <a href="/tjenester/svarut/konfigurasjon-av-svarut/">
        Konfigurasjon av SvarUT
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/signeringstjeneste/" title="Signeringstjeneste" class="dd-item ">
        <a href="/tjenester/svarut/signeringstjeneste/">
        Signeringstjeneste
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/forsendelser-og-sikkerhet/" title="Sikkerhet" class="dd-item ">
        <a href="/tjenester/svarut/forsendelser-og-sikkerhet/">
        Sikkerhet
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/svarinn-mottakservice/" title="SvarInn" class="dd-item ">
        <a href="/tjenester/svarut/svarinn-mottakservice/">
        SvarInn
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/svarut-svarinn-adressering/" title="SvarUt - SvarInn adressering" class="dd-item ">
        <a href="/tjenester/svarut/svarut-svarinn-adressering/">
        SvarUt - SvarInn adressering
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tjenester/svarut/testmiljo/" title="SvarUt Testmiljø" class="dd-item ">
        <a href="/tjenester/svarut/testmiljo/">
        SvarUt Testmiljø
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3></h3>
        <ul>
          
              <li> 
                  <h3>Lenker</h3><a class="padding" href="https://github.com/ks-no/ks-no.github.io"><label>Github repo</label></a>
              </li>
          
              <li> 
                  <a class="padding" href="/index.xml"><img src='/images/feed-icon-28x28.png' aria-hidden='true'>&nbsp;RSS</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='' href="https://github.com/ks-no/ks-no.github.io/edit/source/content/Tjenester/fiksprotokoll/fiksio.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text"></span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>KS Fiks dokumentasjon</a> > <a href='/tjenester/'>Tjenester</a> > <a href='/tjenester/fiksprotokoll/'>Fiks protokoll</a> > Fiks IO
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ol>
    <li><a href="#kort-beskrivelse">Kort beskrivelse</a></li>
    <li><a href="#tilgjengelige-grensesnitt">Tilgjengelige grensesnitt</a></li>
    <li><a href="#beskrivelse">Beskrivelse</a>
      <ol>
        <li></li>
        <li><a href="#hva-trenger-du-for-å-komme-i-gang">Hva trenger du for å komme i gang?</a></li>
        <li><a href="#forhold-til-svarut-og-svarinn">Forhold til SvarUt og SvarInn</a></li>
      </ol>
    </li>
    <li><a href="#teknisk-beskrivelse-av-løsningen">Teknisk beskrivelse av løsningen</a>
      <ol>
        <li><a href="#hvordan-virker-fiks-io">Hvordan virker Fiks IO</a></li>
        <li><a href="#sikkerhet">Sikkerhet</a></li>
        <li><a href="#kontokatalogen">Kontokatalogen</a></li>
        <li><a href="#protokollkatalogen">Protokollkatalogen</a></li>
        <li><a href="#levetid-på-melding-og-ttl-time-to-live">Levetid på melding og TTL (Time To Live)</a></li>
        <li><a href="#standardmeldingstyper">Standardmeldingstyper</a></li>
        <li><a href="#håndtering-av-store-filer">Håndtering av store filer</a></li>
        <li><a href="#klienter">Klienter</a></li>
        <li><a href="#headere-og-properties-i-meldingsutvekslingen">Headere og properties i meldingsutvekslingen</a></li>
      </ol>
    </li>
  </ol>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Fiks IO
            </h1>
          

        



<h2 id="kort-beskrivelse">Kort beskrivelse</h2>
<p>Fiks IO er en kanal for sikker maskin-til-maskin integrasjon. Denne kanalen kan benyttes for å bygge prosesser på tvers av systemer og organisasjoner, for eksempel når et fagsystem skal arkivere et dokument i et arkivsystem eller spørre om informasjon som er lagret i et annet system.</p>
<p>Meldingstyper defineres i <a href="fiksprotokoll">Fiks Protokoll</a></p>
<h2 id="tilgjengelige-grensesnitt">Tilgjengelige grensesnitt</h2>
<table>
<thead>
<tr>
<th>Grensesnitt</th>
<th>Støtte</th>
</tr>
</thead>
<tbody>
<tr>
<td>Web portal</td>
<td>Nei</td>
</tr>
<tr>
<td>Maskin til maskin</td>
<td>Ja</td>
</tr>
</tbody>
</table>
<h2 id="beskrivelse">Beskrivelse</h2>
<p>Fiks IO tilbyr:</p>
<ul>
<li><em>Rask leveranse</em>: ved hjelp av kø-basert arkitektur (<a href="https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol">AMQP)</a> kan Fiks IO levere meldinger raskt, stort sett på under ett sekund plus eventuelt overføring av data. Dette oppnås ved at meldinger nå sendes til det mottakende fagystemet i det øyeblikket de ankommer (push), i stede for at fagsystemet må hente meldingen (pull).</li>
<li><em>Svar på melding</em>: Fiks IO lar en mottaker svare på en spesifikk melding, f.eks. for å svare på en spørring eller å bekrefte at en forespurt handling er utført.</li>
<li><em>Sikker kommunikasjon med ende-til-ende kryptering</em>: Fiks IO tilbyr ende-til-ende kryptering av meldinger. Merk at dette ikke gjelder alle bruks-scenarioer, se &ldquo;Sikkerhet&rdquo; for detaljer.</li>
<li><em>Sikker identifisering av avsender</em>: Bruk av standard for kryptografisk signatur <a href="https://github.com/difi/asic">(ASiC-E)</a> for meldinger gjør at man kan være sikker på identiteten til avsender.</li>
<li><em>Levetid på meldinger</em>: En melding har en default levetid på 7 dager med mindre avsender setter det selv. Minste TTL (se mer om dette lenger nede) man kan sette er 1 sekund.</li>
<li><em>Sending av store filer</em>: Fiks IO integrerer mot <a href="/felles/dokumentlager/">Fiks Dokumentlager</a> for å støtte sending av store filer, helt opp til dokumentlagers grense på fem gigabyte.</li>
</ul>
<p>Merk at Fiks-IO har ikke leveringsgaranti. Det betyr ikke at meldingene kan bli borte i Fiks-IO køene, men vi kan ikke garantere 100% at meldingen går vellykket fra avsender til mottaker da noe f.eks. kan gå galt i håndtering av meldingene.
For eksempel kan en melding bli markert som lest (ack) av en mottaker før den har blitt håndtert helt ferdig og dermed kan ikke meldingen hentes på nytt.
Derfor må mottaker- og avsendersystem lages slik at de håndterer at en melding kan forsvinne underveis.</p>
<h4 id="hvordan-tar-man-i-bruk-fiks-io">Hvordan tar man i bruk Fiks IO?</h4>
<p>Når man oppretter en <a href="fiksprotokoll">Fiks Protokoll</a> konto vil det blir opprettet en Fiks IO konto, samt at man kan administrere meldingstyper som skal benyttes. Vi anbefaler å bruke Fiks Protokoll oppsettet for å få opprettet Fiks IO konto da en Fiks Protokoll konto vil ikke kunne kommunisere med en Fiks IO konto som ikke er opprettet via Fiks Protokoll.
Fiks Protokoll konto er en utvidelse av Fiks IO konto, og dermed får man det man trenger for å f.eks. sette opp en Fiks IO klient.</p>
<p>Fiks IO baserer seg på at organisasjoner benytter Fiks Konfigurasjon for å opprette en eller flere <em>kontoer</em>. Andre organisasjoner kan så sende meldinger til disse kontoene, som mottaker kan lese ved å koble seg til io.fiks.ks.no.</p>
<p>For å gjøre det lettere å finne en konto, og vite hvilke meldingstyper systemet som benytter kontoen kan håndtere kan man konfigurere <em>adresser</em>. Adresser består av en eller flere organisasjonsnummer, meldingsprotokoller og sikkerhetsnivåer. Avsendere kan så slå opp i Fiks IOs katalogtjeneste for å finne f.eks. hvilken konto som skal motta digisos meldinger med sikkerhetsnivå fire for Bergen kommune.</p>
<p>Funksjonalitet for å sende og lese meldinger vil typisk bli tilbudt av fagsystemleverandører eller offentlig virksomheter, som når Fiks Digisos formidler sosialsøknader fra Nav til kommunens sosialsystem, men kommuner og andre organisasjoner må fortsatt ha et forhold til hvilke kontoer de har, hvilke meldingstyper disse håndterer, og ikke minst hvem som har tilgang til å lese inkommende meldinger.</p>
<p><img src="/images/fiksiokonto.png" alt="em fiks-io konto"></p>
<p>I eksempelet over ser man en konto opprettet for å formidle Digisos meldinger til en kommunes fagsystem for behandlig av sosialsøknader. Det er opprettet en adresse på kontoen, &ldquo;Digisos&rdquo;, man har konfigurert støtte for meldingsprotokollen &ldquo;no.nav.digisos.fagsystem.v1&rdquo;, og sagt at dette systemet kan håndtere meldinger for både sikkerhetsnivå tre og fire.</p>
<h3 id="hva-trenger-du-for-å-komme-i-gang">Hva trenger du for å komme i gang?</h3>
<h4 id="virksomhetssertifikat">Virksomhetssertifikat</h4>
<p>Man må ha et virksomhetssertifikat fra Commfides eller Buypass for å identifisere seg med maskinporten, et for test og et for produksjon. Se avsnitt om <a href="#sikkerhet">sikkerhet</a> lenger nede.
Det er viktig at virksomhetssertifikatet er registrert med samme organisasjonsnummer som man registrerer hos maskinporten og hos KS gjennom Fiks-protokoller/Fiks-IO oppsettet.</p>
<h4 id="maskinporten">Maskinporten</h4>
<p>Fiks-IO bruker maskinporten til autentisering. Da må man ha laget en klient hos maskinporten. Se <a href="https://developers.fiks.ks.no/fiks-plattform/difiidportenklient/">her</a> for hvordan det gjøres.
Det er viktig at det gjøres med samme organisasjonsnummer som man har i virksomhetssertifikatet og i Fiks-Protokoller/Fiks-IO oppsettet hos KS.</p>
<h4 id="fiks-protokoll-eller-fiks-io-oppsett">Fiks-protokoll eller Fiks-IO oppsett</h4>
<p>Stort sett vil man bruke <a href="https://ks-no.github.io/fiks-plattform/tjenester/fiksprotokoll">Fiks Protokoll</a> da man skal kommunisere over Fiks-IO med en av protokollene.
Se guiden for oppsett av <a href="https://ks-no.github.io/fiks-plattform/tjenester/fiksprotokoll">Fiks Protokoll</a> for hvordan dette gjøres.</p>
<h4 id="fiks-io">Fiks-IO</h4>
<p>Vi anbefaler å bruke enten java eller .NET klienten som KS tilbyr hvis man er på java eller .NET.
Se github prosjektet for <a href="https://github.com/ks-no/fiks-io-klient-java">java</a> eller <a href="https://github.com/ks-no/fiks-io-client-dotnet">.NET</a> for hvordan man bruker klienten.</p>
<h3 id="forhold-til-svarut-og-svarinn">Forhold til SvarUt og SvarInn</h3>
<p>Fiks IO er en selvstendig kanal, og er ikke bygget for å være en erstatning for SvarUt/SvarInn, som begge vil bli videreført i sin nåværende form. Bruksområdene til tjenestene kan overlappe, og dette gjør at det noen ganger kan være tvil om SvarUt/SvarInn eller Fiks IO er riktig verktøy for et problem.</p>
<p>Hovedsakelig bør man benytte svarut/svarinn for &ldquo;post&rdquo;: meldinger hvor payload er menneske-lesbar (f.eks. en pdf), hvor automatisk håndtering begrenses til f.eks. opprettelse av sak i et arkivsystem, og hvor sending til Altinn eller som brevpost er gode alternativer hvis den automatiske håndteringen feiler. Andre faktorer kan være:</p>
<h4 id="er-dette-en-maskin-til-maskin-integrasjon">Er dette en maskin-til-maskin integrasjon?</h4>
<p>Benytt Fiks IO, denne leverer utelukkende til spesifisert mottakerkonto og benytter ingen alternative kanaler, som for eksempel printet post.</p>
<h4 id="skal-meldingen-sikres-gjennom-ende-til-ende-kryptering">Skal meldingen sikres gjennom ende-til-ende kryptering?</h4>
<p>Benytt Fiks IO, SvarUt/SvarInn meldinger kan bare krypteres med Fiks-plattformens nøkkel, ikke mottakers. Se &ldquo;Sikkerhet&rdquo; for deltajer om hvordan man oppnår trygg ende-til-ende kryptering gjennom Fiks-io</p>
<h4 id="trenger-man-rask-levering">Trenger man rask levering?</h4>
<p>Benytt Fiks IO for å få leveranse på sekunder, ved bruk av SvarUt/SvarInn kan levering ta lang tid, siden SvarUt prøver flere kanaler etter tur og defaulter til print ved leveranseproblemer.</p>
<h4 id="vil-man-at-fiks-plattformen-skal-garantere-at-meldingen-blir-levert">Vil man at fiks-plattformen skal garantere at meldingen blir levert?</h4>
<p>Benytt SvarUt, ved Fiks IO forsendelser risikerer man at meldingen ikke blir håndtert eller avvist av mottaker. Man vil få melding om dette, men man må håndtere evt. retry eller sending via alternative kanaler selv.</p>
<p>Økonomiske aspekter kan også spille inn her, Fiks IO meldinger koster vesentlig mindre pr. stykk enn SvarUt forsendelser.</p>
<h2 id="teknisk-beskrivelse-av-løsningen">Teknisk beskrivelse av løsningen</h2>
<h3 id="hvordan-virker-fiks-io">Hvordan virker Fiks IO</h3>
<p><img src="https://www.lucidchart.com/publicSegments/view/23b3e542-6059-471f-96d6-70f57da44f17/image.png" alt="fiks_io">
En Fiks organisasjon oppretter en Fiks IO <em>konto</em>. Andre kontoer kan nå sende til denne kontoen gjennom Fiks IOs REST api ved å spesifisere kontoens <em>KontoId</em> som mottaker. Organisasjonen får meldingene ved å etablere en AMQP kobling til io.fiks.ks.no.</p>
<p>Fiks IO tar i utgangspunktet ikke stilling til hva payloaden i meldingen består i. Metadataformat, filformat, kryptering og lignende er opp til brukeren, men Fiks plattformen tilbyr tjenester og verktøy for å etablere format for integrasjoner:</p>
<ul>
<li><em>Fiks-IO Kontokatalog</em>: Gir mulighet for å registrere adresser bestående av organisasjonsnummer, sikkerhetsnivå, og hvilke meldingsprotokoller en gitt konto støtter. Andre kan så gjøre oppslag mot denne katalogen for å finne riktig konto å sende en melding til.</li>
<li><em>Fiks-IO Protokollkatalog</em>: Tilbyr en katalog over registrerte meldingsprotokoller. En protokoll er en oversikt over hvilke meldingstyper som inngår i en kommunikasjon, gjerne også med skjema som spesifiserer syntax for de enkelte typene.</li>
<li><em>Fiks-IO java klient</em>: <a href="https://github.com/ks-no/fiks-io-klient-java">Java klient</a> som tilbyr funksjonalitet for å bygge, signere, kryptere, og sende meldinger som ASiC-E pakker, samt mottak og dekryptering på andre siden.</li>
<li><em>Fiks-IO .net klient</em>: <a href="https://github.com/ks-no/fiks-io-client-dotnet">.net core</a> implementasjon av samme funksjonalitet som klienten over.</li>
</ul>
<h3 id="sikkerhet">Sikkerhet</h3>
<p>Autentisering av klienter mot REST service for sending av meldinger og AMQP service for leveranse av meldinger skjer gjennom virksomhetssertifikat-basert maskinporten autentisering.</p>
<p>I utgangspunktet legger ikke Fiks IO føringer på hvordan (eller om) en melding sendt over plattformen sikres, men alle klienter som utvikles av KS, og alle protokoller som Fiks spesifiserer, vil benytte signerte og krypterte meldinger gjennom <a href="https://github.com/difi/asic">ASIC-E</a> containere. Denne standarden benyttes også av DIFI i forbindelse med integrasjonspunktet. I klientene skjer signering med samme sertifikat som blir benyttet for autentisering mot maskinporten, kryptering skjer med sertifikatet som mottaker har publisert i Fiks IO Kontokatalog.</p>
<p>Merk at man for å oppnå reell ende-til-ende kryptering, i betydningen at KS ikke har noen mulighet til å lese den overførte meldingen, bør innhente mottakers sertifikater gjennom egne kanaler og selv verifisere disse. Fiks-IO tilbyr automatisk oppslag i katalogen som en tjeneste for å lette dette arbeidet, men man bør være klar over at det å benytte denne gir noe svekket sikkerhet.</p>
<h3 id="kontokatalogen">Kontokatalogen</h3>
<p>For å sende en melding i Fiks IO må man kjenne konto-id&rsquo;en til mottakeren, men for å støtte mer dynamisk bruk tilbys Fiks IO Kontokatalog. Dette er et register over Fiks IO kontoer og tilknyttede adresser. En adresse består av:</p>
<ul>
<li><em>Identifikator</em>: Autoriserende identifikator for adressen. Dette vil i første omgang være begrenset til organisasjonsnummer, men kan senere utvides. For organisasjonsnummer benyttes Altinn for autorisering: personen som legger til adressen må ha rollen &ldquo;post/arkiv&rdquo; på den aktuelle organisasjonen.</li>
<li><em>Protokoll</em>: Spesifiserer hvilken protokoll adressen gjelder for. En protokoll vil som regel omfatte flere meldingstyper.</li>
<li><em>Sikkerhetsnivå</em>: Spesifiserer hvilket sikkerhetsnivå meldingen skal ha. Typisk benyttes nivå 3 for ikke sensitive og nivå 4 for sensitive meldinger.</li>
</ul>
<p>Adresser opprettes og forvaltes gjennom Fiks Konfigrasjon. Katalogen gir også mulighet for å laste opp en offentlig nøkkel i form av et X509 sertifikat. Dette sertifikatet blir benyttet for å kryptere meldinger sendt til kontoen, slik at de kan dekrypteres med den private delen av nøkkelen ved mottak.</p>
<p>Fiks Organisasjoner kan gjøre oppslag i registrerte adresser gjennom <a href="https://editor.swagger.io/?url=https://developers.fiks.ks.no/api/fiksio-katalog-api-v1.json">katalog-api&rsquo;et</a>.</p>
<p>Merk at bruk av dette api&rsquo;et i stede for manuell innhenting av sertifikater kan gi noe redusert sikkerhet. Se &ldquo;Sikkerhet&rdquo; for detaljer.</p>
<h3 id="protokollkatalogen">Protokollkatalogen</h3>
<p>Som nevnt over har Fiks IO i utgangspunktet ingen formening om hva innholdet i en melding er, men det er i mange integrasjon-scenarioer nyttig å ha et felles repository med kontrakter for hvordan meldinger skal bygges opp. Protokollkatalogen tilbyr en slik oversikt, og man kan her referere til spesifikasjoner for meldingstypene som inngår i protokollen, og hvordan disse skal benyttes.</p>
<p>Digisos bruker som nevnt over meldingsprotokollen &ldquo;no.nav.digisos.fagsystem.v1&rdquo;, som er beskrevet i mer detalj under <a href="https://ks-no.github.io/fiks-plattform/tjenester/digisos/#fiks-io-meldingsprotokoll">Fiks Digisos</a>.</p>
<p>Ta kontakt med <a href="mailto:fiks@ks.no">fiks@ks.no</a> om du ønsker å etablere eller gjøre endringer i en protokoll.</p>
<h3 id="levetid-på-melding-og-ttl-time-to-live">Levetid på melding og TTL (Time To Live)</h3>
<p>Når man sender en melding via Fiks-IO klienten kan man velge å sette en levetid (TTL) selv på meldingen, men med minimum 1 sekund.
Hvis man ikke setter levetid selv blir TTL satt til 7 dager i Fiks-IO tjenesten.</p>
<p>TTL fungerer slik at den blir trigget når meldingen kommer fremst i køen til mottaker. Dette fører til en svakhet hvis man har meldinger på samme kø med forskjellig TTL.</p>
<p>La oss ta følgende eksempel:</p>
<p>Hvis det er flere meldinger på køen, nr 1 i køen har en TTL på 7 dager, nr 2 har en TTL på 10 sekunder. Mottaker systemet er nede i 1 time.
Da vil ikke det bli trigget en TTL og sendt en “tidsavbrudd” melding tilbake til avsender (se avsnitt om standardmeldingstyper) før den første meldingen blir konsumert (eller går ut på tid). Altså får man ikke “tidsavbrudd” meldingen tilbake innen forventet tid. Dette betyr at første melding i køen avgjør når man får tidsavbrudd melding tilbake.</p>
<h3 id="standardmeldingstyper">Standardmeldingstyper</h3>
<p>Dette er meldingstyper som sendes fra Fiks-IO.</p>
<h4 id="tidsavbrudd">Tidsavbrudd</h4>
<p>Meldingstype: <code>no.ks.fiks.kvittering.tidsavbrudd</code></p>
<p>Denne meldingen forteller at din meldings TTL har utløpt.
Denne meldingen blir sendt til avsender når originalmeldingen kommer fremst i køen til mottaker og TTL er utgått.
Som beskrevet tidligere betyr dette at man ikke kan si med sikkerhet at man vil få en tidsavbrudd melding når avsendt meldings TTL går ut, da meldingen foran i køen kan ha lenger TTL.</p>
<p>Disse tidsavbrudd-meldingene inneholder ingen body, men kun <a href="#Headere-og-properties-i-meldingsutvekslingen">headere</a>.</p>
<h4 id="serverfeil">Serverfeil</h4>
<p>Meldingstype: <code>no.ks.fiks.kvittering.serverfeil.v1</code></p>
<p>Hvis man får denne Fiks-IO serverfeil meldingen tilbake så betyr det at noe har gått galt og Fiks-IO har håndtert det.
Akkurat nå sendes meldingen når det har vært forsøkt levert 3 ganger. F.eks. mottaker har hentet ned meldingen uten å “acke” meldingen 3 ganger, eller at mottaker har nacket med requeue 3 ganger.</p>
<p>Merk at de fleste protokollene har også en serverfeil meldingstype som kan sendes fra mottaker av din melding.
Hvis man får protokollens serverfeil melding tilbake, f.eks. for Fiks-Arkiv med meldingstypen <code>no.ks.fiks.arkiv.v1.feilmelding.serverfeil</code>, så vil det bety at mottaker feilet og sendte denne meldingen kontrollert tilbake med en mulighet for å beskrive hva som gikk galt (forhåpentligvis acket meldingen og sendte denne serverfeil meldingen tilbake).</p>
<h3 id="håndtering-av-store-filer">Håndtering av store filer</h3>
<p>Fiks IO støtter sending av store filer ved at alle meldinger større enn 5 megabyte mellomlagres i Fiks Dokumentlager, i en dedikert konto som opprettes sammen med Fiks IO kontoen. En referanse til denne lagrede filen blir så sendt over AMQP. Filer sendt på slik måte får en time-to-live i dokumentlager lik time-to-live for meldingen + 24 timer. Etter dette vil de automatisk slettes.</p>
<p>Hvis man benytter java eller .net klienten utviklet av KS vil denne mellomlagringen oppleves sømløst - klienten streamer automatisk filer fra dokumentlageret om dette er benyttet.</p>
<h3 id="klienter">Klienter</h3>
<p>For å gjøre integrasjon lettere vil KS utvikle klienter som benyttes for både sending og mottak av meldinger fra Fiks IO.
Det er to klienter, en Fiks-IO klient som håndterer muligheten for både å motta og sende meldinger og en Fiks-IO send-klient som man kan bruke hvis man bare skal sende meldinger.
Fiks-IO send-klienten vil da ikke behøve amqp-kobling da den kun sender meldinger via Fiks-IO API.</p>
<table>
<thead>
<tr>
<th>Klient</th>
<th>Pakkenavn</th>
<th>Beskrivelse</th>
<th>Github</th>
</tr>
</thead>
<tbody>
<tr>
<td>Fiks-IO klient Java</td>
<td>fiks-io-klient-java</td>
<td>Klient for å motta og sende meldinger</td>
<td><a href="https://github.com/ks-no/fiks-io-klient-java">https://github.com/ks-no/fiks-io-klient-java</a></td>
</tr>
<tr>
<td>Fiks-IO klient .net</td>
<td>KS.Fiks.IO.Client</td>
<td>Klient for å motta og sende meldinger</td>
<td><a href="https://github.com/ks-no/fiks-io-client-dotnet">https://github.com/ks-no/fiks-io-client-dotnet</a></td>
</tr>
<tr>
<td>Fiks-IO send klient Java</td>
<td>fiks-io-send-klient</td>
<td>Klient <strong>kun</strong> for å sende meldinger</td>
<td><a href="https://github.com/ks-no/fiks-io-send-klient">https://github.com/ks-no/fiks-io-send-klient</a></td>
</tr>
<tr>
<td>Fiks-IO send klient .net</td>
<td>KS.Fiks.IO.Send.Client</td>
<td>Klient <strong>kun</strong> for å sende meldinger</td>
<td><a href="https://github.com/ks-no/fiks-io-send-client-dotnet">https://github.com/ks-no/fiks-io-send-client-dotnet</a></td>
</tr>
</tbody>
</table>
<p>Andre språk vil vurderes, og vi vil gjerne høre fra deg om du skriver klienter for andre språk.</p>
<h3 id="headere-og-properties-i-meldingsutvekslingen">Headere og properties i meldingsutvekslingen</h3>
<p>For at meldingene skal kunne sendes til korrekt mottaker og svares på er det en del faste headers eller properties man må sette.
Headerene er slik de ser ut i amqp mens properties er hvordan klienter og API har navngitt tilsvarende attributter. Klienter og API oversetter altså til egne property navn fra og til slik de ser ut som amqp headere.
Merk at man har også en map med navnet &ldquo;headere&rdquo; som man kan sende eller man mottar med en melding. Dette er ekstra headere man kan sende ved meldingene.
Hvis man bruker Fiks-IO klientene for java eller .net som KS har laget vil man stort sett ikke trenge å forholde seg til headerene (altså amqp-navnene) da man bruker ferdig funksjonalitet og kodet modeller med properties for å sende og svare på meldinger.
Noen navn vil avvike litt mellom header og modell, som f.eks. headeren <code>svar-til</code> tilsvarer <code>SvarPaMelding</code> i koden for modellen for en melding for både java og .net. Se tabellen under for mapping mellom header og tilsvarende property navn man finner i klientkoden.</p>
<table>
<thead>
<tr>
<th>Header i amqp</th>
<th>Property navn</th>
<th>Beskrivelse</th>
</tr>
</thead>
<tbody>
<tr>
<td>avsender-id</td>
<td>AvsenderKontoId</td>
<td>Avsenders Fiks IO-konto eller Protokoll konto</td>
</tr>
<tr>
<td>melding-id</td>
<td>MeldingId</td>
<td>Meldingens ID. Denne skal ikke settes selv, men vil bli gitt av Fiks-IO når man sender en melding</td>
</tr>
<tr>
<td>type</td>
<td>MeldingType</td>
<td>Meldingstype</td>
</tr>
<tr>
<td>dokumentlager-id</td>
<td>-</td>
<td>ID til eventuell fil lagret i Dokumentlager. Relevant ved mottatt melding.</td>
</tr>
<tr>
<td>svar-til</td>
<td>SvarPaMelding</td>
<td>Hvis meldingen er svar på en tidligere Fiks IO-melding, vil svar-til referere til den meldingens <code>melding-id</code></td>
</tr>
<tr>
<td>svar-til-type</td>
<td>-</td>
<td>På <code>no.ks.fiks.kvittering.tidsavbrudd</code> meldinger legges typen til den opprinnelige meldingen i <code>svar-til-type</code></td>
</tr>
<tr>
<td>klientmelding-id</td>
<td>KlientMeldingId</td>
<td>En  id som avsender gjenbruker ved resending av en melding</td>
</tr>
<tr>
<td>-</td>
<td>Resendt</td>
<td>Denne settes hvis melding har blitt resendt pga mottaker har gjort &lsquo;NackWithRequeue&rsquo;</td>
</tr>
<tr>
<td><ditt-navn></td>
<td>Headere (map)</td>
<td>Man kan sende ved egne properties</td>
</tr>
</tbody>
</table>
<p><strong>Headere (map)</strong></p>
<p>Her kan man sende inn i en map egendefinerte navn-verdi properties i en map som man ønsker å sende med meldingen.
Hvis man bruker Fiks IO klientene vil det legges på en &ldquo;egendefinert-header.&rdquo; prefix for hver egendefinert header.</p>
<p><strong>Resendt</strong></p>
<p>Resendt betyr at en melding er resendt pga mottaker har gjort en &lsquo;NackWithRequeue&rsquo;. Dette er ikke en header men en status vi får fra rabbitmq.</p>
<p><strong>dokumentlager-id</strong></p>
<p>Denne får man kun hvis meldingens payload har overskredet grensen for filstørrelse og dermed blitt lagret i dokumentlageret.
Hvis man bruker Fiks-IO klienten i .net eller java vil man ikke trenge å forholde seg til dette da klienten forenkler dette og henter eventuelt filen fra dokumentlageret for deg.</p>
<p><strong>klientmelding-id (KlientMeldingID)</strong></p>
<p>Denne id er ikke påbudt men kan benyttes for å identifisere en melding som sendes på nytt fra avsender. Den skal være ny og unik for hver melding men brukes på nytt når man resender en melding.
Dette er i motsetning til <code>melding-id</code> som blir unik og ny for hver eneste melding, også hvis man sender en melding på nytt. Hvis man bruker Fiks IO klienten i java eller .net vil man sette denne som en vanlig property.
Dette vil man altså ikke trenge å forholde seg til hvis man bruker de tilgjengelige Fiks IO klientene da de tolker dette atributtet for deg.</p>
<h4 id="sending-av-melding">Sending av melding</h4>
<p>Når man sender en melding til Fiks-IO API vil den se slik ut:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#111">{</span>
  <span style="color:#f92672">&#34;MeldingId&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;00000000-0000-0000-0000-000000000000&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;KlientMeldingId&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;MeldingType&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;no.ks.fiks.arkiv.v1.arkivering.arkivmelding&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;AvsenderKontoId&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;MottakerKontoId&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Ttl&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;2.00:00:00&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Headere&#34;</span><span style="color:#111">:{},</span>
  <span style="color:#f92672">&#34;SvarPaMelding&#34;</span><span style="color:#111">:</span><span style="color:#00a8c8">null</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Resendt&#34;</span><span style="color:#111">:</span><span style="color:#00a8c8">false</span>
<span style="color:#111">}</span>
</code></pre></div><p><strong>MeldingId</strong> vil være en tom guid da man ikke setter den men får den som en ny og unik generert guid tilbake fra API.
<strong>Headere</strong> skal her kun inneholde eventuelt egendefinerte properties man ønsker å sende i meldingen.
<strong>MottakerKontoId</strong> blir ikke til en amqp header men identifiserer hvilken kø meldingen skal til.</p>
<p>Svaret man får tilbake fra API ved send vil da se helt lik ut til det man sendte samt en ny generert <strong>MeldingId</strong>:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#111">{</span>
  <span style="color:#f92672">&#34;MeldingId&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;ca544416-267a-40d4-8e4c-86d14cd0a51f&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;KlientMeldingId&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;MeldingType&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;no.ks.fiks.arkiv.v1.arkivering.arkivmelding&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;AvsenderKontoId&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;MottakerKontoId&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Ttl&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;2.00:00:00&#34;</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Headere&#34;</span><span style="color:#111">:</span> <span style="color:#111">{},</span>
  <span style="color:#f92672">&#34;SvarPaMelding&#34;</span><span style="color:#111">:</span> <span style="color:#00a8c8">null</span><span style="color:#111">,</span>
  <span style="color:#f92672">&#34;Resendt&#34;</span><span style="color:#111">:</span> <span style="color:#00a8c8">false</span>
<span style="color:#111">}</span>
</code></pre></div><h4 id="mottak-av-melding">Mottak av melding</h4>
<p>Når man mottar en melding i Fiks-IO klienten så vil man få ferdig mappet fra amqp headere til properties i modellen <code>MottattMeldingMetadata</code> i java og .net.
Property <strong>SvarPaMelding</strong> (amqp headeren <code>svar-til</code>) vil da eventuelt inneholde den <strong>MeldingId</strong> den er et svar på, altså den id du fikk tildelt da du sendte opprinnelig melding.
Er det en melding man ønsker å svare på selv kan man bruke den innebyggede Svar( &hellip; ) funksjonaliteten i Fiks IO klienten som vil da sørge for at <strong>SvarPaMelding</strong> blir korrekt.
Alternativt hvis man ikke kan bruke Svar-funksjonaliteten ut av boksen, må man sørge for å sette korrekt <strong>MeldingId</strong> i <strong>SvarPaMelding</strong> property når man sender meldingen tilbake.</p>
<p>Hvis man ikke bruker Fiks IO klienten fra KS vil man måtte gjøre tolkning av amqp headerene selv.</p>
<h4 id="meldingsutveksling-og-fiks-io">Meldingsutveksling og Fiks-IO</h4>
<p><img src="/images/fiksio-meldingsutveksling.png" alt="em fiks-io meldingsutveksling"></p>
<p>Her ser man hvordan Fiks-IO klienten, Fiks-IO API og køene henger sammen i en meldingsutveksling mellom to system.</p>
<p>I dette eksempelet sender <strong>System A</strong> en melding fra Fiks-IO klienten til Fiks-IO API. Fiks-IO API putter det på køen til <strong>System B</strong>.
<strong>System B</strong> bruker Fiks-IO klienten for å lytte på køen i Fiks-IO og mottar meldingen. <strong>System B</strong> gjør som <strong>System A</strong> og sender svar på meldingen til Fiks-IO API via Fiks-IO klienten.
Fiks-IO API putter svarmeldingen på køen til <strong>System A</strong>.
<strong>System A</strong> lytter og mottar svar på meldingen på sin egen kø via Fiks-IO klienten.</p>
<p>Merk at det er egentlig bare ett Fiks-IO API som begge systemene bruker, men det er tegnet inn som 2 forskjellige bokser for å tydeligere vise flyten.</p>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
        
                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/tjenester/fiksprotokoll/plan/" title="Fiks plan"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/tjenester/fiksprotokoll/matrikkelfoering/" title="Fiks matrikkelføring" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1679307551"></script>
    <script src="/js/perfect-scrollbar.min.js?1679307551"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1679307551"></script>
    <script src="/js/jquery.sticky.js?1679307551"></script>
    <script src="/js/featherlight.min.js?1679307551"></script>
    <script src="/js/highlight.pack.js?1679307551"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1679307551"></script>
    <script src="/js/learn.js?1679307551"></script>
    <script src="/js/hugo-learn.js?1679307551"></script>

    <link href="/mermaid/mermaid.css?1679307551" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1679307551"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

